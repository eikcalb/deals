(this.webpackJsonpunidays=this.webpackJsonpunidays||[]).push([[0],{124:function(e,a,t){e.exports=t.p+"static/media/logo.25bf045c.svg"},261:function(e,a,t){e.exports=t(618)},500:function(e,a,t){},514:function(e,a,t){},618:function(e,a,t){"use strict";t.r(a);t(262),t(311);var n=t(1),r=t.n(n),s=t(96),l=t.n(s),c=(t(500),t(20)),i=t(12),o=t(22),u=t(49),m=t(48),d=(t(514),t(5)),p=t.n(d),v=t(59),h=t(60),f=t(33),E=t.n(f),b={apiKey:"AIzaSyDRlJC_SV_wCL5eTDxVY24e3mHVGFJLNxg",authDomain:"unidays-3205e.firebaseapp.com",databaseURL:"https://unidays-3205e.firebaseio.com",projectId:"unidays-3205e",storageBucket:"unidays-3205e.appspot.com",messagingSenderId:"127396561143",appId:"1:127396561143:web:a032c8f3b20540fc4e53f2",measurementId:"G-6HPPCPKTZ6"};Object(f.initializeApp)(b);var g=Object(f.analytics)(),N=t(100),y=t(99),w=t(101);function x(){var e;(e=console).log.apply(e,arguments)}var k=E.a.functions(),O=E.a.auth(),j=E.a.database().ref("users"),D=E.a.database().ref("vendors"),C=E.a.database().ref("deals"),L=E.a.database().ref("library"),S=function(){function e(a){var t=this;Object(v.a)(this,e),this.uid=void 0,this.displayName=void 0,this.fUser=void 0,this.isAnonymous=!1,this.myDeals=[],this._userReady=void 0,this.uid=a.uid,this.displayName=a.displayName?a.displayName:"",this.fUser=a,this.isAnonymous=this.fUser.isAnonymous,this._userReady=new Promise((function(e,a){t.isAnonymous||fetch("".concat(b.databaseURL,"/library/").concat(t.uid,".json?shallow=true")).then((function(e){return e.json()})).then((function(e){t.myDeals=Object.keys(e)})).finally((function(){return e(!0)}))}))}return Object(h.a)(e,[{key:"isVendor",value:function(){return!1}},{key:"dealExists",value:function(e){return this.myDeals.find((function(a){return a===e}))||!1}},{key:"saveDeal",value:function(e){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.dealExists(e.id)){a.next=2;break}return a.abrupt("return");case 2:return a.next=4,p.a.awrap(L.child("".concat(this.uid,"/").concat(e.id)).set(e));case 4:this.myDeals.push(e.id);case 5:case"end":return a.stop()}}),null,this)}}],[{key:"register",value:function(a){var t,n,r,s;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(t=a.displayName,n=a.email,r=a.password,O.currentUser){l.next=4;break}throw O.signInAnonymously(),new Error("This is weird! Application must start with atleast an anonymous user!");case 4:return s=E.a.auth.EmailAuthProvider.credential(n,r),l.abrupt("return",O.currentUser.linkWithCredential(s).then((function(a){var r;return p.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(a.user){s.next=2;break}throw new Error("User should not be empty!");case 2:return r=a.user,console.log("Anonymous account successfully upgraded",r),s.next=6,p.a.awrap(r.updateProfile({displayName:t}).then((function(){return j.child(r.uid).set({displayName:t,email:n})})).catch((function(e){throw x(e),r.delete(),new Error("Could not register user!")})));case 6:return s.abrupt("return",new e(r));case 7:case"end":return s.stop()}}))}),(function(e){throw console.log("Error upgrading anonymous account",e),new Error(e.message)})));case 6:case"end":return l.stop()}}))}},{key:"login",value:function(a,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",O.signInWithEmailAndPassword(a,t).then((function(a){if(!a.user)throw new Error("User not found!");return new e(a.user)})).catch((function(e){var a=e.code;throw console.log(e),"auth/wrong-password"===a?new Error("Wrong password."):e})));case 1:case"end":return n.stop()}}))}}]),e}(),I=function(e){function a(e,t){var n;return Object(v.a)(this,a),(n=Object(N.a)(this,Object(y.a)(a).call(this,e))).companyName=void 0,n.companyName=t,n}return Object(w.a)(a,e),Object(h.a)(a,[{key:"isVendor",value:function(){return!0}}],[{key:"register",value:function(e){var t,n,r,s,l,c,i;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(t=e.companyName,n=e.displayName,r=e.email,s=e.password,O.currentUser){o.next=4;break}throw O.signInAnonymously(),new Error("This is weird! Application must start with atleast an anonymous user!");case 4:return l=k.httpsCallable("vendorSignup"),o.prev=5,o.next=8,p.a.awrap(l({email:r,password:s,displayName:n,companyName:t}));case 8:if(c=o.sent,console.log(c),c.data.success){o.next=12;break}throw new Error("Something went wrong!");case 12:return o.next=14,p.a.awrap(O.signInWithEmailAndPassword(r,s));case 14:if((i=o.sent).user){o.next=17;break}throw new Error("Something went horribly wrong!");case 17:return o.abrupt("return",new a(i.user,t));case 20:throw o.prev=20,o.t0=o.catch(5),console.error(o.t0),o.t0;case 24:case"end":return o.stop()}}),null,null,[[5,20]])}},{key:"login",value:function(e,t){return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",O.signInWithEmailAndPassword(e,t).then((function(e){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.user){n.next=2;break}throw new Error("User not found!");case 2:return n.next=4,p.a.awrap(new Promise((function(a,t){D.child("".concat(e.user.uid,"/companyName")).once("value",(function(e){if(e.exists())return a(e.val());O.signOut(),t(new Error("Vendor account not found! Did you mean to login as a user?"))}))})));case 4:return t=n.sent,n.abrupt("return",new a(e.user,t));case 6:case"end":return n.stop()}}))})).catch((function(e){var a=e.code;throw console.log(e),"auth/wrong-password"===a?new Error("Wrong password."):e})));case 1:case"end":return n.stop()}}))}}]),a}(S),T={main:{background:"#eee",color:"#002",minHeight:"100%",overflowY:"scroll",paddingTop:"3.25rem"},mainDark:{background:"#001",color:"#efefef",minHeight:"100%",overflowY:"scroll",paddingTop:"3.25rem"},level1:{background:"#222"},header:{background:"#fefefe",color:"#353545",boxShadow:"#1a1a1a38 0 1px 0.1em 0.1em"},footer:{padding:"1em",color:"#eee",background:"#444455"}},P=t(55),M=t.n(P),A=t(82),z=t.n(A),F=function(){function e(a){Object(v.a)(this,e),this.context=void 0,this.useMock=!1,this.useMock&&console.info("Bail application. Wrong code sent for production!!!!!!"),this.context=a,window.v=M.a}return Object(h.a)(e,[{key:"inflateDeal",value:function(e){var a,t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.author.CompanyName){n.next=6;break}return a=D.child("".concat(e.author.id,"/companyName")),n.next=4,p.a.awrap(a.once("value").then((function(e){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!e.exists()){a.next=2;break}return a.abrupt("return",e.val());case 2:case"end":return a.stop()}}))})));case 4:t=n.sent,e.author.CompanyName=t;case 6:return n.abrupt("return",e);case 7:case"end":return n.stop()}}))}},{key:"getDeal",value:function(e){var a=this;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",C.child(e).once("value").then((function(e){if(e.exists())return a.inflateDeal(e.val());throw new Error("Deal not found!")})));case 1:case"end":return t.stop()}}))}},{key:"getMyDeals",value:function(){var e=this;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(this.context.signedIn()){a.next=2;break}return a.abrupt("return",[]);case 2:if(!this.useMock){a.next=4;break}return a.abrupt("return",V);case 4:return a.next=6,p.a.awrap(new Promise((function(a){L.child("".concat(e.context.user.uid)).once("value",(function(t){var n,r,s,l;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t.exists()){c.next=2;break}return c.abrupt("return",a([]));case 2:n=t.val(),console.log(n),r=[],c.t0=p.a.keys(n);case 6:if((c.t1=c.t0()).done){c.next=16;break}return s=c.t1.value,l=n[s],c.t2=r,c.next=12,p.a.awrap(e.inflateDeal(l));case 12:c.t3=c.sent,c.t2.push.call(c.t2,c.t3),c.next=6;break;case 16:return c.abrupt("return",a(r.reverse()));case 17:case"end":return c.stop()}}))}))})));case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}}),null,this)}},{key:"getDeals",value:function(e){var a,t,n=this;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=10,!e){r.next=9;break}if(!this.useMock){r.next=6;break}return t=V.findIndex((function(a){return a.id===e})),console.log(t,e,V),r.abrupt("return",V.slice(t>0?t+1:0,Math.max(t,0)+1+a));case 6:return r.next=8,p.a.awrap(C.orderByKey().endAt(e).limitToLast(2).once("value").then((function(a){var t,r,s,l;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(a.exists()){c.next=2;break}return c.abrupt("return",[]);case 2:t=a.val(),console.log("all deals",t),r=[],c.t0=p.a.keys(t);case 6:if((c.t1=c.t0()).done){c.next=18;break}if((s=c.t1.value)!==e){c.next=10;break}return c.abrupt("continue",6);case 10:return l=t[s],c.t2=r,c.next=14,p.a.awrap(n.inflateDeal(l));case 14:c.t3=c.sent,c.t2.push.call(c.t2,c.t3),c.next=6;break;case 18:return c.abrupt("return",r.reverse());case 19:case"end":return c.stop()}}))})));case 8:return r.abrupt("return",r.sent);case 9:if(!this.useMock){r.next=11;break}return r.abrupt("return",V.slice(0,a));case 11:return r.next=13,p.a.awrap(C.orderByKey().limitToLast(a).once("value").then((function(e){var a,t,r,s;return p.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(e.exists()){l.next=2;break}return l.abrupt("return",[]);case 2:a=e.val(),t=[],l.t0=p.a.keys(a);case 5:if((l.t1=l.t0()).done){l.next=17;break}if(r=l.t1.value,!((s=a[r]).expiry&&Date.now()>=s.expiry)){l.next=10;break}return l.abrupt("continue",5);case 10:return l.t2=t,l.next=13,p.a.awrap(n.inflateDeal(s));case 13:l.t3=l.sent,l.t2.push.call(l.t2,l.t3),l.next=5;break;case 17:return l.abrupt("return",t.reverse());case 18:case"end":return l.stop()}}))})));case 13:return r.abrupt("return",r.sent);case 14:case"end":return r.stop()}}),null,this)}},{key:"addDeal",value:function(a){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.context.signedIn()&&this.context.user.isVendor()){n.next=2;break}throw new Error("You are not authorized to create deals!");case 2:if(a.cover){n.next=4;break}throw new Error("You must specify a cover image for this deal!");case 4:return t=Object(f.functions)().httpsCallable("vendorCreateDeal"),e.isDealValid(a),n.prev=6,n.next=9,p.a.awrap(t({deal:a}));case 9:if(n.sent.data.success){n.next=12;break}throw new Error("Failed to create deal!");case 12:return g.logEvent("create_deal"),n.abrupt("return",!0);case 16:throw n.prev=16,n.t0=n.catch(6),console.error(n.t0),n.t0;case 20:case"end":return n.stop()}}),null,this,[[6,16]])}},{key:"saveDeal",value:function(e){var a;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.context.isStudent()){t.next=2;break}throw new Error("Only students can save deals!");case 2:return t.prev=2,t.next=5,p.a.awrap(null===(a=this.context.user)||void 0===a?void 0:a.saveDeal(e));case 5:return t.abrupt("return",!0);case 8:throw t.prev=8,t.t0=t.catch(2),console.error(t.t0),t.t0;case 12:case"end":return t.stop()}}),null,this,[[2,8]])}},{key:"removeDeal",value:function(e){var a;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.context.signedIn()&&this.context.user.isVendor()&&e.author.id===(null===(a=this.context.user)||void 0===a?void 0:a.uid)){t.next=2;break}throw new Error("You are not authorized to manage deals!");case 2:if(t.prev=2,!e.cover){t.next=6;break}return t.next=6,p.a.awrap(Object(f.storage)().refFromURL(e.cover).delete());case 6:return t.next=8,p.a.awrap(L.child("".concat(this.context.user.uid,"/").concat(e.id)).remove());case 8:return t.next=10,p.a.awrap(C.child(e.id).remove());case 10:return t.abrupt("return",!0);case 13:throw t.prev=13,t.t0=t.catch(2),console.error(t.t0),t.t0;case 17:case"end":return t.stop()}}),null,this,[[2,13]])}}],[{key:"isDealValid",value:function(e){if(!e.title||!M.a.isLength(e.title,{min:5}))throw Error("Deal must contain a useful title!");if(!e.description||!M.a.isLength(e.description,{min:10}))throw new Error("Deal must have useful description!");if(!e.value)throw new Error("All deals must have a value!");if(e.meta=e.meta||{unit:"FLAT"},!e.meta.unit||!M.a.equals(e.meta.unit,"PERCENT")&&!M.a.equals(e.meta.unit,"FLAT"))throw new Error("Invalid unit format");if(e.meta.expiryDate&&!z()(e.meta.expiryDate).isAfter())throw new Error("Invalid expiry date!");return!0}}]),e}(),V=[{id:"11",cover:"fff",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Dominos Pizza"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30,inStore:!0},{id:"12",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Taxify"},description:"Walk in to any store and get these deals in november only",title:"50% off any purchase",value:30,meta:{expiryDate:1580697479e3,unit:"FLAT",actionUrl:"nairaland.com"},cover:t(124),inStore:!0},{id:"13",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"FilmHouse Cinemas"},description:"Test deals spooled by me##",title:"80% off any purchase",cover:t(124),value:30},{id:"14",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"14d",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"1s4",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"14dd",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"1s4d",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"14dss",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30},{id:"1s4ss",author:{id:"dsdusdsdusudsdusdsuds",CompanyName:"Microsoft"},description:"Test deals spooled by me##",title:"30% off any purchase",value:30}],U=new(function(){function e(){var a=this;Object(v.a)(this,e),this.name="My Student Deal",this.description="Bringing the most exciting shopping discounts and deals to students worldwide!",this.version="0.0.1",this.theme=T,this.user=void 0,this.dealMan=void 0,this._isReady=void 0,document.title=this.name,this.dealMan=new F(this),this._isReady=new Promise((function(e){O.onAuthStateChanged((function(t){var n;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=16;break}if(!t.isAnonymous){r.next=6;break}console.log("Anonymous user created",t),a.user=new S(t),r.next=14;break;case 6:if(!a.user||a.user.isAnonymous){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,p.a.awrap(t.getIdTokenResult());case 10:return r.sent.claims.vendor?((n=JSON.parse(localStorage.getItem("user_session_")||"{}"))||(O.signOut(),console.log("Anonymous user created",t),a.user=new S(t)),console.log("currently signedin as ",n.companyName,t),a.user=new I(t,n.companyName),g.setUserId(t.uid)):(console.log("currently signedin as ",t.displayName,t),a.user=new S(t),g.setUserId(t.uid)),r.next=14,p.a.awrap(a.user._userReady);case 14:r.next=18;break;case 16:a.user=void 0,a.user||O.signInAnonymously();case 18:e(!0);case 19:case"end":return r.stop()}}))}))}))}return Object(h.a)(e,[{key:"isReady",value:function(){return this._isReady}},{key:"isStudent",value:function(){return this.user&&this.signedIn()&&!this.user.isVendor()}},{key:"signedIn",value:function(){return this.user&&!this.user.isAnonymous}},{key:"loginStudent",value:function(e){var a=this;return S.login(e.email,e.password).then((function(e){return a.user=e,a}))}},{key:"loginVendor",value:function(e){var a=this;return I.login(e.email,e.password).then((function(e){return a.user=e,localStorage.setItem("user_session_",JSON.stringify({companyName:e.companyName})),a}))}},{key:"registerUser",value:function(e){var a=this;return S.register(e).then((function(e){a.user=e}))}},{key:"registerVendor",value:function(e){var a=this;return I.register(e).then((function(e){a.user=e,localStorage.setItem("user_session_",JSON.stringify({companyName:e.companyName}))}))}},{key:"logout",value:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.awrap(O.signOut());case 2:localStorage.removeItem("user_session_"),this.user&&(this.user=void 0);case 4:case"end":return e.stop()}}),null,this)}},{key:"getVendorCount",value:function(){var e;return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.t0=p.a,a.next=3,p.a.awrap(fetch("".concat(b.databaseURL,"/vendors.json?shallow=true")));case 3:return a.t1=a.sent.json(),a.next=6,a.t0.awrap.call(a.t0,a.t1);case 6:if(e=a.sent){a.next=9;break}return a.abrupt("return",0);case 9:return a.abrupt("return",Object.keys(e).length);case 10:case"end":return a.stop()}}))}}]),e}()),R=Object(n.createContext)(U),_=function(){return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("footer",{className:"footer",style:e.theme.footer},r.a.createElement("div",{className:"content is-unselectable has-text-centered"},r.a.createElement("p",null,"\xa9 ",(new Date).getFullYear()," ",e.name," ")))}))},q="/deals",W="/deals",Y="/deals",B="/deals",H="/deals",J="/mydeals",G="/user/view",K=t(258),X=t(9);function Z(e){var a=e.hideMenu,t=Object(n.useContext)(R),s=r.a.useState(!1),l=Object(c.a)(s,2),u=l[0],m=l[1];return a?r.a.createElement("nav",{className:"navbar is-centered is-unselectable is-fixed-top",style:t.theme.header},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("span",{className:"navbar-item has-text-weight-bold"},t.name))):r.a.createElement("nav",{className:"navbar is-centered is-unselectable is-fixed-top",style:t.theme.header},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement("span",{className:"navbar-item has-text-weight-bold"},t.name),r.a.createElement("span",{onClick:function(){var e=!u;m(e),!0===e&&setTimeout((function(){return m(!1)}),1e4)},className:"navbar-burger burger ".concat(u?"is-active":"")},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null))),r.a.createElement("div",{className:"navbar-menu ".concat(u?"is-active":"")},r.a.createElement("div",{className:"navbar-start"},t.signedIn()?r.a.createElement(o.b,{activeClassName:"is-active",exact:!0,to:J,className:"navbar-item"},r.a.createElement(i.t,null),"\u2003My Deals"):r.a.createElement(o.b,{activeClassName:"is-active",exact:!0,to:"/",className:"navbar-item"},r.a.createElement(i.k,null),"\u2003Home"),r.a.createElement(o.b,{activeClassName:"is-active",exact:!0,to:H,className:"navbar-item"},r.a.createElement(i.p,null),"\xa0 Deals")),r.a.createElement("div",{className:"navbar-end"},t.signedIn()?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"navbar-item"}),r.a.createElement(o.b,{title:"View profile",activeClassName:"is-active",exact:!0,to:G,className:"navbar-item"},r.a.createElement(i.s,null),"\u2003Hello ",t.user.isVendor()?t.user.companyName:t.user.displayName)):null,r.a.createElement("div",{className:"navbar-item"},t.signedIn()?r.a.createElement(o.b,{title:"Logout",activeClassName:"is-active",exact:!0,to:"/".concat(t.user.isVendor()?"vendor":"user","/logout"),className:"is-danger button"},r.a.createElement(i.n,null),"\u2003Logout"):r.a.createElement("div",{className:"field is-grouped is-uppercase"},r.a.createElement("p",{className:"control"},r.a.createElement(o.b,{title:"Login to student portal",activeClassName:"is-active",exact:!0,to:"/user/login",className:"is-primary button"},r.a.createElement(i.m,null),"\u2003Student")),r.a.createElement("p",{className:"control"},r.a.createElement(o.b,{title:"Login to vendor portal!",activeClassName:"is-active",exact:!0,to:"/vendor/login",className:"is-link button"},r.a.createElement(i.a,null),"\u2003Vendor")))))))}var $=t(56),Q=t(77),ee=["Contacting Mothership...","Configuring Defences...","Loading...","Ready In A Minute...","Launching..."],ae=function(){var e=Object(n.useContext)(R),a=Object(n.useState)(ee[Math.round(Math.random()*ee.length)%ee.length]),t=Object(c.a)(a,2),s=t[0],l=t[1],i=setInterval((function(){i&&clearInterval(i),l(ee[Math.round(Math.random()*ee.length)%ee.length])}),2e3);return Object(n.useEffect)((function(){return function(){clearInterval(i)}})),r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,{hideMenu:!0}),r.a.createElement("div",{className:"hero is-fullheight is-black is-bold"},r.a.createElement("div",{className:"hero-body has-text-centered"},r.a.createElement("div",{className:"container"},r.a.createElement("p",{className:"title has-text-weight-bold is-2"},"Welcome to ",e.name),r.a.createElement("p",{className:"subtitle"},e.description),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"section"},r.a.createElement("p",{className:"subtitle"},s),r.a.createElement("progress",{className:"progress is-small is-info",max:"100"},"loading"))))))},te=["info","success","link","warning","danger","primary"],ne=function(e){var a=e.phrase,t=void 0===a?"Loading...":a,s=Object(n.useState)("info"),l=Object(c.a)(s,2),i=l[0],o=l[1];return Object(n.useEffect)((function(){var e=setInterval((function(){return o(te[Math.round(Math.random()*te.length)%te.length])}),900);return function(){return clearInterval(e)}})),r.a.createElement("div",{className:"container has-text-centered"},r.a.createElement("p",{className:"subtitle"},t),r.a.createElement("progress",{className:"progress is-small is-".concat(i),max:"100"},"loading"))},re=t(256),se=t.n(re),le=function(e){var a=e.user,t=e.dealMan,s={error:null,inStore:"ONLINE",title:"",description:"",value:"",expiryTime:"",expiryDate:"",cover:null,link:"",type:"FLAT",loading:!1,coverFile:null},l=Object(n.useState)(s),o=Object(c.a)(l,2),d=o[0],v=o[1],h=Object(m.useToasts)().addToast;return r.a.createElement("form",{className:"card has-transition-1 is-unselectable",onSubmit:function(e){var n,r,s,l;return p.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(e.preventDefault(),e.stopPropagation(),a.isVendor()||h("Only vendors can create deals",{appearance:"error"}),!d.loading){c.next=6;break}return h("Deal creation already in progress!",{appearance:"info",autoDismiss:!0}),c.abrupt("return");case 6:if(v(Object(X.a)({},d,{loading:!0,error:null})),!(d.title&&d.title.length>4&&d.description&&d.description.length>4&&d.cover&&d.value)){c.next=32;break}if(c.prev=8,"ONLINE"!==d.inStore||d.link){c.next=11;break}throw new Error("All online deals must have a url or voucher code!");case 11:if(!d.expiryDate||!d.expiryTime){c.next=17;break}if(!((n=new Date("".concat(d.expiryDate," ").concat(d.expiryTime))).getTime()<=Date.now())){c.next=15;break}throw new Error("Expiry must be greater than today!");case 15:c.next=19;break;case 17:if(!(d.expiryTime&&!d.expiryDate||d.expiryDate&&!d.expiryTime)){c.next=19;break}throw new Error("Both expiry date and time must be set!");case 19:r={title:d.title,description:d.description,author:{id:a.uid},id:"",value:d.value,inStore:"ONLINE"!==d.inStore,meta:{unit:d.type,actionUrl:d.link,expiryDate:n?n.getTime():void 0}},F.isDealValid(r),s=d.cover.name.split("."),(l=Object(f.storage)().ref("images/".concat(Date.now().toString(36),"_").concat(btoa(s[0]),"_").concat(s[s.length-1]))).put(d.cover).then((function(e){return p.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if("success"!==e.state){a.next=6;break}return a.next=3,p.a.awrap(l.getDownloadURL());case 3:r.cover=a.sent,a.next=9;break;case 6:throw l.delete(),console.log(e),new Error("Failed to save file properly!");case 9:return a.next=11,p.a.awrap(t.addDeal(r).catch((function(e){throw l.delete(),e})));case 11:h("Deal created successfully!",{appearance:"success",autoDismiss:!0}),v(Object(X.a)({},d,{error:"",loading:!1}));case 13:case"end":return a.stop()}}))})).catch((function(e){v(Object(X.a)({},d,{error:e.message||"Failed to upload. Please try again",loading:!1}))})),c.next=30;break;case 26:c.prev=26,c.t0=c.catch(8),v(Object(X.a)({},d,{error:c.t0.message||"Failed to upload. Please try again",loading:!1}));case 30:c.next=33;break;case 32:v(Object(X.a)({},d,{error:"Invalid values entered!",loading:!1}));case 33:case"end":return c.stop()}}),null,null,[[8,26]])}},r.a.createElement(u.a,{message:"You have made changes to this page. Really want to leave now?",when:!se.a.isEqual(d,s)}),r.a.createElement("header",{className:"card-header"},r.a.createElement("p",{className:"card-header-title is-uppercase"},"Create New Deal"),r.a.createElement("span",{onClick:function(){d.loading||v(s)},className:"card-header-icon ".concat(d.loading?"has-text-grey":"has-text-danger is-size-4")}," ",r.a.createElement(Q.b,null))),d.coverFile?r.a.createElement("div",{className:"card-image"},r.a.createElement("figure",{className:"image is-16by9"},r.a.createElement("img",{src:d.coverFile,alt:d.description}))):null,r.a.createElement("div",{className:"card-content"},d.error?r.a.createElement("div",{className:"notification is-danger"},r.a.createElement(i.f,null)," ",d.error):null,r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{value:d.title,onChange:function(e){return v(Object(X.a)({},d,{title:e.target.value}))},tabIndex:1,className:"input",required:!0,disabled:d.loading,minLength:4,type:"text",placeholder:"Title"}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"file has-name is-fullwidth ".concat(d.cover?"is-success":"")},r.a.createElement("label",{className:"file-label"},r.a.createElement("input",{onChange:function(e){if(e.target.files&&e.target.files.length>0&&e.target.files[0].size>10){var a=e.target.files[0];if(a.size/1024>700)return void h("File is too large! Please select a different file!",{appearance:"error",autoDismiss:!0});if("FileReader"in window){var t=new FileReader;t.onload=function(e){var t;v(Object(X.a)({},d,{cover:a,coverFile:null===(t=e.target)||void 0===t?void 0:t.result}))},t.readAsDataURL(a)}else v(Object(X.a)({},d,{cover:a}))}else v(Object(X.a)({},d,{cover:null}))},className:"file-input",required:!0,tabIndex:2,type:"file",accept:"image/*",alt:"Cover photo for deal",disabled:d.loading}),r.a.createElement("span",{className:"file-cta"},r.a.createElement("span",{className:"file-icon"},r.a.createElement(Q.d,null)),r.a.createElement("span",{className:"is-uppercase file-label ".concat(d.cover?"has-text-white":"has-text-grey")},"Select Cover image")),r.a.createElement("span",{className:"file-name"},d.cover?d.cover.name:"no file chosen")))))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("textarea",{tabIndex:3,className:"textarea",value:d.description,onChange:function(e){return v(Object(X.a)({},d,{description:e.target.value}))},disabled:d.loading,required:!0,maxLength:150,rows:2,placeholder:"Describe what this deal has to offer..."}))),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control",title:"Select deal availability. This will guide users on where this deal can be applied."},r.a.createElement("div",{className:"select is-fullwidth"},r.a.createElement("select",{tabIndex:4,value:d.inStore,onChange:function(e){return v(Object(X.a)({},d,{inStore:e.target.value}))},disabled:d.loading},r.a.createElement("option",{value:"ONLINE"},"Online"),r.a.createElement("option",{value:"STORE"},"Instore"))))),r.a.createElement("div",{className:"field has-addons"},r.a.createElement("div",{className:"control"},r.a.createElement("div",{className:"select"},r.a.createElement("select",{tabIndex:5,value:d.type,onChange:function(e){return v(Object(X.a)({},d,{type:e.target.value}))},disabled:d.loading},r.a.createElement("option",{value:"PERCENT"},"%"),r.a.createElement("option",{value:"FLAT"},"\u20a6")))),r.a.createElement("div",{className:"control is-expanded"},r.a.createElement("input",{tabIndex:6,value:d.value,onChange:function(e){return v(Object(X.a)({},d,{value:e.target.value}))},className:"input is-uppercase",disabled:d.loading,required:!0,type:"number",step:.01,placeholder:"Discount or Percentage"}))))),"ONLINE"!==d.inStore?null:r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{type:"text",tabIndex:7,value:d.link,onChange:function(e){return v(Object(X.a)({},d,{link:e.target.value}))},disabled:d.loading,className:"input",placeholder:"Voucher Code or Web URL (starting with http://)"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.j,null)))),r.a.createElement("label",{className:"label is-uppercase has-text-grey"},"Expiry (optional)"),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{className:"input",tabIndex:8,value:d.expiryTime,disabled:d.loading,onChange:function(e){return v(Object(X.a)({},d,{expiryTime:e.target.value}))},type:"time",placeholder:"Time deal will expire"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.c,null)))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{name:"date",tabIndex:9,disabled:d.loading,value:d.expiryDate,onChange:function(e){return v(Object(X.a)({},d,{expiryDate:e.target.value}))},className:"input",type:"date",pattern:"[0-9]{4}/[0-9]{2}/[0-9]{2}"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.b,null)))))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"is-fullwidth control"},r.a.createElement("button",{type:"submit",tabIndex:10,disabled:d.loading,className:"button is-primary is-uppercase ".concat(d.loading?"is-loading":"")},"submit")))))},ce=function(e){function a(){var e,t;Object(v.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=Object(N.a)(this,(e=Object(y.a)(a)).call.apply(e,[this].concat(r)))).context=void 0,t.state={deals:[],isLoading:!0},t}return Object(w.a)(a,e),Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.dealMan.getMyDeals().then((function(a){e.setState({deals:a,isLoading:!1})}))}},{key:"render",value:function(){var e,a=this.context,t=this.state,n=t.deals,s=t.isLoading;return a.signedIn()?r.a.createElement("div",{style:a.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"section"},(null===(e=a.user)||void 0===e?void 0:e.isVendor())?r.a.createElement(le,{user:a.user,dealMan:a.dealMan}):null,r.a.createElement("div",{className:"section is-marginless-horizontal"},s?r.a.createElement(ne,{phrase:"Fetching Your deals..."}):null,r.a.createElement("div",{className:"columns is-multiline"},n.length>0?n.map((function(e){return r.a.createElement("div",{key:e.id,className:"column is-3-widescreen is-4 is-12-mobile"},r.a.createElement(oe,{deal:e}))})):r.a.createElement("div",{className:"column has-text-centered has-text-grey"},r.a.createElement("br",null),r.a.createElement(Q.c,{className:"is-size-1"}),r.a.createElement("br",null),"No Data available yet!")))))):r.a.createElement(u.b,{to:"/"})}}]),a}(n.PureComponent);ce.contextType=R;var ie=function(e){function a(){var e,t;Object(v.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=Object(N.a)(this,(e=Object(y.a)(a)).call.apply(e,[this].concat(r)))).context=void 0,t.state={deals:[],isLoading:!0},t}return Object(w.a)(a,e),Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.dealMan.getDeals().then((function(a){e.setState({deals:a,isLoading:!1})}))}},{key:"render",value:function(){var e=this,a=this.context,t=this.state,n=t.isLoading,s=t.deals;return r.a.createElement("div",{style:a.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"container is-fluid"},r.a.createElement("div",{className:"section is-marginless-horizontal"},r.a.createElement("div",{className:"columns is-multiline"},s.map((function(e){return r.a.createElement("div",{key:e.id,className:"column is-3-widescreen is-4 is-12-mobile"},r.a.createElement(oe,{deal:e}))}))),r.a.createElement("div",{className:"container"},r.a.createElement("button",{type:"button",disabled:n,onClick:function(){var t;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return e.setState({isLoading:!0}),t=window.scrollY,n.t0=s.push,n.t1=s,n.t2=K.a,n.next=7,p.a.awrap(a.dealMan.getDeals(s[s.length-1].id));case 7:n.t3=n.sent,n.t4=(0,n.t2)(n.t3),n.t0.apply.call(n.t0,n.t1,n.t4),e.setState({deals:s,isLoading:!1}),window.scroll(window.scrollX,t);case 12:case"end":return n.stop()}}))},className:"button is-primary is-uppercase is-fullwidth ".concat(n?"is-loading":"")},"Load More")))))}}]),a}(r.a.PureComponent);ie.contextType=R;var oe=function(e){var a,s,l=e.deal,u=Object(n.useContext)(R),d=Object(m.useToasts)().addToast,v=Object(n.useState)({loading:!1,savingDeal:!1,exists:null===(a=u.user)||void 0===a?void 0:a.dealExists(l.id)}),h=Object(c.a)(v,2),f=h[0],E=h[1],b=l.meta&&l.meta.expiryDate?z()(new Date(l.meta.expiryDate)):void 0;return r.a.createElement("div",{className:"card is-deal-card is-unselectable"},r.a.createElement("div",{className:"card-image"},r.a.createElement("figure",{className:"image is-16by9"},r.a.createElement("img",{src:l.cover||t(124),alt:l.description}))),r.a.createElement("div",{className:"card-content has-text-centered"},l.meta?r.a.createElement("div",{className:"title has-text-weight-bold"},M.a.equals(l.meta.unit,"FLAT")?"\u20a6 ".concat(l.value.toLocaleString()):"".concat(l.value,"%")):null,r.a.createElement("p",{className:"title is-5"},l.title),r.a.createElement("p",{className:"subtitle is-6 is-deal-description"},l.description),b?r.a.createElement("span",{className:"is-positioned-top tag is-medium ".concat(b.isBefore(Date.now())?"is-danger":"is-warning"),title:"Deal set to expire on ".concat(b.toLocaleString())},r.a.createElement(i.c,null),"\xa0 ",b.isBefore(Date.now())?"Expired":"Until ".concat(b.calendar())):null,r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"field is-grouped-centered is-grouped"},r.a.createElement("div",{className:"control"},r.a.createElement(o.b,{onClick:function(e){var a;return p.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.isStudent()){t.next=18;break}if(a=u.user,E(Object(X.a)({},f,{savingDeal:!0})),a.dealExists(l.id)){t.next=18;break}if(t.prev=4,!window.confirm("Want to this deal?")){t.next=10;break}return t.next=8,p.a.awrap(u.dealMan.saveDeal(l).then((function(){return E(Object(X.a)({},f,{savingDeal:!1}))})));case 8:t.next=11;break;case 10:throw new Error("User not interested!");case 11:t.next=18;break;case 13:t.prev=13,t.t0=t.catch(4),console.error(t.t0),e.preventDefault(),e.stopPropagation();case 18:case"end":return t.stop()}}),null,null,[[4,13]])},className:"button is-success is-outlined",to:{state:{deal:l},pathname:"/deals/view/".concat(l.id)}},r.a.createElement($.f,null),"\xa0 ",f.exists?"View Deal":"Get Deal")),(null===(s=u.user)||void 0===s?void 0:s.isVendor)&&l.author.id===u.user.uid?r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-danger ".concat(f.loading?"is-loading":""),onClick:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm('You have tried to delete deal with title "'.concat(l.title,'".\r\nDo you want to delete this deal?'))){e.next=2;break}return e.abrupt("return");case 2:E(Object(X.a)({},f,{loading:!0})),u.dealMan.removeDeal(l).then((function(){return d("Deal successfully removed!",{appearance:"success",autoDismiss:!0})})).catch((function(e){d(e.message||"An error occurred!",{appearance:"error",autoDismiss:!0})})).finally((function(){return E(Object(X.a)({},f,{loading:!1}))}));case 4:case"end":return e.stop()}}))}},"Delete")):null)),r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"title is-6"},r.a.createElement($.e,null)," ",l.author.CompanyName),r.a.createElement("p",{className:"subtitle tags"},r.a.createElement("span",{className:"tag ".concat(l.inStore?"is-primary":"is-link")},l.inStore?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.o,null),"\xa0 instore"):r.a.createElement(r.a.Fragment,null,r.a.createElement(i.d,null),"\xa0 online")))))))};function ue(e){return r.a.createElement(R.Consumer,null,(function(a){return r.a.createElement("div",{style:a.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"hero is-black is-bold is-fullheight"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container notification has-text-centered",style:a.theme.level1},r.a.createElement(i.g,{size:50,className:"has-text-warning"}),r.a.createElement("p",{className:"title is-uppercase"}," ",e.children||"Page Not Found!"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(o.b,{to:e.redirect||"/",className:"button is-danger is-outlined"},e.redirectText||"Go to Homepage!")))))}))}var me=function(){var e=Object(n.useContext)(R),a=r.a.useState(0),t=Object(c.a)(a,2),s=t[0],l=t[1];if(e.signedIn())return r.a.createElement(u.b,{to:J});return e.getVendorCount().then((function(e){return function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=setInterval((function(){if(e!==s){var n=s+a;n>e?(l(e),clearInterval(t)):l(n)}else clearInterval(t)}),Math.max(Math.ceil(e/a)),0)}(e)})),r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"hero is-fullheight is-light is-bold"},r.a.createElement("div",{className:"hero-body has-text-centered has-background"},r.a.createElement("div",{className:"container"},r.a.createElement("p",{className:"title has-text-weight-bold is-2"},"Welcome to ",e.name),r.a.createElement("p",{className:"subtitle"},e.description)))),r.a.createElement("div",{className:"hero is-medium is-primary is-bold"},r.a.createElement("div",{className:"hero-body has-text-centered"},r.a.createElement("div",{className:"container"},r.a.createElement("p",{className:"title is-capitalized"},"Gain access to thousands of great student discounts!"),r.a.createElement("div",{className:"tile is-ancestor section"},r.a.createElement(o.b,{to:W,className:"tile is-parent"},r.a.createElement("div",{className:"tile is-child box"},r.a.createElement($.c,{className:"is-size-1"}),r.a.createElement("p",{className:"subtitle has-text-black has-text-weight-bold"},"Fashion"))),r.a.createElement(o.b,{to:B,className:"tile is-parent"},r.a.createElement("div",{className:"tile is-child box"},r.a.createElement($.d,{className:"is-size-1"}),r.a.createElement("p",{className:"subtitle has-text-black has-text-weight-bold"},"Technology"))),r.a.createElement(o.b,{to:q,className:"tile is-parent"},r.a.createElement("div",{className:"tile is-child box"},r.a.createElement($.a,{className:"is-size-1"}),r.a.createElement("p",{className:"subtitle has-text-black has-text-weight-bold"},"Transportation"))),r.a.createElement(o.b,{to:Y,className:"tile is-parent"},r.a.createElement("div",{className:"tile is-child box"},r.a.createElement($.b,{className:"is-size-1"}),r.a.createElement("p",{className:"subtitle has-text-black has-text-weight-bold"},"Events & Lifestyle"))))))),r.a.createElement("div",{className:"hero is-medium is-dark"},r.a.createElement("div",{className:"hero-body has-text-centered"},r.a.createElement("div",{className:"container"},r.a.createElement($.e,{className:"is-size-1"}),r.a.createElement("p",{className:"subtitle"},"Vendors Registered"),r.a.createElement("p",{className:"title has-text-weight-bold is-1"},s)))))},de=function(e){var a=e.redirectPath,t=e.registerPath,n=e.onLogin,s=r.a.useState({error:null,email:"",password:"",isLoading:!1}),l=Object(c.a)(s,2),d=l[0],p=l[1],v=r.a.useState(!1),h=Object(c.a)(v,2),f=h[0],E=h[1],b=r.a.useState(!1),g=Object(c.a)(b,2),N=g[0],y=g[1],w=Object(m.useToasts)().addToast;return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),p(Object(X.a)({},d,{isLoading:!0})),n(d).then((function(){return console.log("login success"),w("Login Success!",{appearance:"success",autoDismiss:!0}),p(Object(X.a)({},d,{isLoading:!1})),y(!0)})).catch((function(e){p(Object(X.a)({},d,{isLoading:!1,error:e.message}))}))}},N?r.a.createElement(u.b,{to:a}):null,r.a.createElement("div",{className:"card"},r.a.createElement("section",{className:"card-content"},d.error?r.a.createElement("div",{className:"notification is-warning"},r.a.createElement(i.f,null)," ",d.error):null,r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Email")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{required:!0,name:"email",value:d.email,onChange:function(e){return p(Object(X.a)({},d,{email:e.target.value}))},className:"input",type:"email",placeholder:"Enter email address"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.e,null)))))),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Password")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field has-addons"},r.a.createElement("p",{className:"control is-expanded"},r.a.createElement("input",{required:!0,name:"password",value:d.password,onChange:function(e){return p(Object(X.a)({},d,{password:e.target.value}))},className:"input",type:f?"text":"password"})),r.a.createElement("p",{className:"control"},r.a.createElement("button",{tabIndex:-1,type:"button",className:"button",onClick:function(){return E(!f)}},f?r.a.createElement(i.i,null):r.a.createElement(i.h,null)))))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{type:"submit",className:"is-success button ".concat(d.isLoading?"is-loading":""),disabled:d.isLoading},"Login")))),r.a.createElement("footer",{className:"card-footer is-unselectable"},r.a.createElement(o.b,{to:t,exact:!0,className:"card-footer-item"},"Create New Account"))))}))},pe=function(e){var a=e.redirectPath,t=e.onRegister,n=e.vendor,s=e.loginPath,l=r.a.useState({error:"",email:"",password:"",passwordVerify:"",isLoading:!1,showPassword:!1,displayName:"",companyName:""}),d=Object(c.a)(l,2),p=d[0],v=d[1],h=Object(m.useToasts)().addToast,f=r.a.useState(!1),E=Object(c.a)(f,2),b=E[0],g=E[1];return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),e.stopPropagation(),p.password!==p.passwordVerify)return v(Object(X.a)({},p,{error:"Passwords do not match!"}));v(Object(X.a)({},p,{isLoading:!0})),t(p).then((function(){return h("Registration Success!",{appearance:"success",autoDismiss:!0}),v(Object(X.a)({},p,{isLoading:!1})),g(!0)})).catch((function(e){v(Object(X.a)({},p,{isLoading:!1,error:e.message}))}))}},b?r.a.createElement(u.b,{to:a}):null,r.a.createElement("div",{className:"card"},r.a.createElement("section",{className:"card-content"},p.error?r.a.createElement("div",{className:"notification is-warning"},r.a.createElement(i.f,null)," ",p.error):null,n?r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Company Name")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{required:!0,name:"companyname",value:p.companyName,onChange:function(e){return v(Object(X.a)({},p,{companyName:e.target.value}))},className:"input",type:"text",placeholder:"Enter company name"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.a,null)))))):null,r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Name")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{required:!0,name:"name",value:p.displayName,onChange:function(e){return v(Object(X.a)({},p,{displayName:e.target.value}))},className:"input",type:"person",placeholder:"Enter your fullname"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.r,null)))))),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Email")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control has-icons-left"},r.a.createElement("input",{required:!0,name:"email",value:p.email,onChange:function(e){return v(Object(X.a)({},p,{email:e.target.value}))},className:"input",type:"email",placeholder:"Enter email address"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.e,null)))))),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Password")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field has-addons"},r.a.createElement("p",{className:"control is-expanded has-icons-left"},r.a.createElement("input",{required:!0,name:"password",value:p.password,onChange:function(e){return v(Object(X.a)({},p,{password:e.target.value}))},className:"input",type:p.showPassword?"text":"password"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.l,null))),r.a.createElement("p",{className:"control"},r.a.createElement("button",{disabled:p.isLoading,tabIndex:-1,className:"button",type:"button",onClick:function(){return v(Object(X.a)({},p,{showPassword:!p.showPassword}))}},p.showPassword?r.a.createElement(i.i,null):r.a.createElement(i.h,null)))))),r.a.createElement("div",{className:"field is-horizontal"},r.a.createElement("div",{className:"field-label"},r.a.createElement("label",{className:"label"},"Confirm Password")),r.a.createElement("div",{className:"field-body"},r.a.createElement("div",{className:"field"},r.a.createElement("p",{className:"control has-icons-left"},r.a.createElement("input",{required:!0,name:"password",value:p.passwordVerify,onChange:function(e){return v(Object(X.a)({},p,{passwordVerify:e.target.value}))},className:"input",type:p.showPassword?"text":"password"}),r.a.createElement("span",{className:"icon is-small is-left"},r.a.createElement(i.l,null)))))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("button",{type:"submit",className:"is-success button ".concat(p.isLoading?"is-loading":""),disabled:p.isLoading},"Join")))),r.a.createElement("footer",{className:"card-footer"},r.a.createElement(o.b,{to:s,exact:!0,className:"card-footer-item"},"Login with existing account"))))}))},ve=function(){return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"section container"},r.a.createElement("h2",{className:"is-title is-size-2 has-text-centered"},"Login with username and password"),r.a.createElement("div",{className:"section"},r.a.createElement(de,{onLogin:function(a){return e.loginStudent(a)},redirectPath:"/",registerPath:"/user/register"}))))}))},he=function(){return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"section container"},r.a.createElement("h2",{className:"is-title is-size-2 has-text-centered"},"Login with username and password"),r.a.createElement("div",{className:"section"},r.a.createElement(de,{onLogin:function(a){return e.loginVendor(a)},redirectPath:"/",registerPath:"/vendor/register"}))))}))},fe=function(){var e=Object(n.useContext)(R),a=Object(n.useState)(!0),t=Object(c.a)(a,2),s=t[0],l=t[1];return e.signedIn(),e.logout().then((function(){return l(!1)})),r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"section container"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"hero is-fullheight"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("h2",{className:"is-title is-size-2"},"Thank you for using ",e.name,"!"),s?r.a.createElement("progress",{className:"progress is-small is-info",max:"100"},"loading..."):null)))))},Ee=function(){return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"section container"},r.a.createElement("h2",{className:"is-title is-size-2 has-text-centered"},"Create a new account"),r.a.createElement("div",{className:"section"},r.a.createElement(pe,{onRegister:function(a){return e.registerUser(a)},redirectPath:"/",loginPath:"/user/login"}))))}))},be=function(){return r.a.createElement(R.Consumer,null,(function(e){return r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"section container"},r.a.createElement("h2",{className:"is-title is-size-2 has-text-centered"},"Create a new vendor account"),r.a.createElement("div",{className:"section"},r.a.createElement(pe,{vendor:!0,onRegister:function(a){return e.registerVendor(a)},redirectPath:"/",loginPath:"/vendor/login"}))))}))},ge=t(126),Ne=function(){var e=Object(n.useContext)(R),a=Object(u.j)().id,t=Object(u.i)().state,s=e.user&&!e.user.isAnonymous,l=Object(n.useState)({loading:!t||!t.deal,error:s?"":"You are not authenticated! Please login to view details!",deal:s&&t?t.deal:null}),i=Object(c.a)(l,2),o=i[0],m=i[1];return Object(n.useEffect)((function(){s&&(o.deal||(a?e.dealMan.getDeal(a).then((function(e){m(Object(X.a)({},o,{loading:!1,deal:e,error:""}))})).catch((function(e){return m(Object(X.a)({},o,{error:e.message,loading:!1,deal:null}))})):m(Object(X.a)({},o,{loading:!1,error:"Deal could not be found!"}))))}),[a,s,o,e.dealMan,e.user]),o.loading?r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"section"},r.a.createElement(ne,{phrase:"Fetching details"})))):o.error||!o.deal?r.a.createElement(ue,null,o.error):r.a.createElement(ye,{deal:o.deal})},ye=function(e){var a,s,l=e.deal,d=Object(n.useContext)(R),v=Object(m.useToasts)().addToast,h=(Object(u.h)().goBack,Object(n.useState)({loading:!1})),f=Object(c.a)(h,2),E=f[0],b=f[1];if(!l)throw new Error("Dunno how this happened!!!!");if(d.isStudent()&&!d.user.dealExists(l.id))return r.a.createElement(ue,null,"You have to accept a deal before viewing!");g.logEvent("view_item",{item:l.id});var N=l.meta&&l.meta.expiryDate?z()(new Date(l.meta.expiryDate)):void 0;return l.meta&&l.meta.actionUrl&&M.a.isURL(l.meta.actionUrl,{protocols:["https"],require_protocol:!0})?r.a.createElement("div",{style:Object(X.a)({},d.theme.main,{display:"flex"})},r.a.createElement(Z,null),r.a.createElement("div",{className:"content",style:{flex:1}},r.a.createElement("iframe",{src:l.meta.actionUrl,title:l.title,seamless:!0,style:{border:"none",width:"100%",height:"100%"}}))):r.a.createElement("div",{style:d.theme.main},r.a.createElement(Z,null),r.a.createElement("figure",{className:"image is-unselectable is-16by9"},r.a.createElement("img",{src:l.cover||t(124),alt:l.description})),r.a.createElement("div",{className:"container is-unselectable has-text-centered"},r.a.createElement("div",{className:"container"},r.a.createElement("nav",{className:"breadcrumb is-centered","aria-label":"breadcrumbs"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.b,{to:H},"Deals")),r.a.createElement("li",{className:"is-active"},r.a.createElement("a",{"aria-current":"page"},l.title.length>12?l.title.substr(0,12).padEnd(15,"..."):l.title))))),r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"content"},l.meta?r.a.createElement("div",{className:"title is-size-2 has-text-weight-bold"},M.a.equals(l.meta.unit,"FLAT")?"\u20a6 ".concat(l.value.toLocaleString()):"".concat(l.value,"%")):null,r.a.createElement("i",null),r.a.createElement("p",{className:"subtitle is-centered tags"},r.a.createElement("span",{className:"tag ".concat(l.inStore?"is-primary":"is-link")},l.inStore?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.o,null),"\xa0 instore"):r.a.createElement(r.a.Fragment,null,r.a.createElement(i.d,null),"\xa0 online")),N?r.a.createElement("span",{className:"tag subtitle ".concat(N.isBefore(Date.now())?"is-danger":"is-warning"),title:"Deal set to expire on ".concat(N.toLocaleString())},r.a.createElement(i.c,null),"\xa0 ",N.isBefore(Date.now())?"Expired":"Expiring ".concat(N.calendar())):null)),r.a.createElement("div",{className:"section"},r.a.createElement("p",{className:"title is-4"},l.title),r.a.createElement("p",{className:"subtitle"},l.description),r.a.createElement("div",{className:"level is-mobile"},r.a.createElement("div",{className:"level-item"},r.a.createElement("div",null,r.a.createElement("p",{className:"heading is-uppercase"},r.a.createElement($.e,null)," Company name"),r.a.createElement("p",{className:"subtitle"},l.author.CompanyName)))),r.a.createElement("div",{className:"content"},l.meta&&l.meta.actionUrl?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"field has-addons has-addons-centered"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input is-uppercase is-medium",id:"actionUrl",readOnly:!0,type:"text",value:null===(a=l.meta)||void 0===a?void 0:a.actionUrl})),r.a.createElement("div",{title:"Copy code",className:"control"},r.a.createElement("button",{className:"button is-medium",onClick:function(){var e=document.getElementById("actionUrl");e&&(e.focus(),e.select(),navigator.clipboard?navigator.clipboard.writeText(e.value).then((function(){return v("Copied!",{appearance:"success",autoDismiss:!0})})):document.execCommand("copy",!0,e.value)&&v("Copied!",{appearance:"success",autoDismiss:!0}))}},r.a.createElement(Q.a,null))),(null===(s=d.user)||void 0===s?void 0:s.isVendor)&&l.author.id===d.user.uid?r.a.createElement("div",{title:"Delete deal",className:"control"},r.a.createElement("button",{className:"button is-medium is-danger ".concat(E.loading?"is-loading":""),onClick:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.confirm('You have tried to delete deal with title "'.concat(l.title,'".\r\nDo you want to delete this deal?'))){e.next=2;break}return e.abrupt("return");case 2:b({loading:!0}),d.dealMan.removeDeal(l).then((function(){return v("Deal successfully removed!",{appearance:"success",autoDismiss:!0})})).catch((function(e){v(e.message||"An error occurred!",{appearance:"error",autoDismiss:!0})})).finally((function(){return b({loading:!0})}));case 4:case"end":return e.stop()}}))}},r.a.createElement(Q.e,null))):null)):null)),r.a.createElement(ge.Twitter,{link:window.location.href,message:l.title}),r.a.createElement(ge.Mail,{link:window.location.href,subject:l.title}),r.a.createElement(ge.Whatsapp,{link:window.location.href,message:l.title}))))},we=function(){var e=Object(n.useContext)(R),a=r.a.useState(0),t=Object(c.a)(a,2);t[0],t[1];return!e.user||e.user.isAnonymous?r.a.createElement(ue,null,"You must be authenticated to view this page!"):r.a.createElement("div",{style:e.theme.main},r.a.createElement(Z,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"section"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-content"})))))},xe=function(){var e=Object(n.useState)(!1),a=Object(c.a)(e,2),t=a[0],s=a[1],l=Object(n.useState)(navigator.onLine),d=Object(c.a)(l,2),p=d[0],v=d[1],h=Object(m.useToasts)().addToast;return window.onoffline=function(){p&&(v(!1),h("You are offline!",{appearance:"warning",autoDismiss:!0,pauseOnHover:!0}))},window.ononline=function(){p||(v(!0),h(r.a.createElement("p",null,"Welcome back to the Internet \xa0",r.a.createElement(i.q,null)),{appearance:"info",autoDismiss:!0,pauseOnHover:!0}))},r.a.createElement(R.Provider,{value:U},r.a.createElement(R.Consumer,null,(function(e){return e.isReady().then((function(e){return s(e)})),r.a.createElement(o.a,null,t?r.a.createElement(r.a.Fragment,null,r.a.createElement(u.e,null,r.a.createElement(u.c,{strict:!0,exact:!0,path:"/deals/view/:id",component:Ne}),r.a.createElement(u.c,{strict:!0,exact:!0,path:H,component:ie}),r.a.createElement(u.c,{strict:!0,exact:!0,path:J,component:ce}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/vendor/register",component:be}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/user/register",component:Ee}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/vendor/login",component:he}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/user/login",component:ve}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/:user/logout",component:fe}),r.a.createElement(u.c,{strict:!0,exact:!0,path:G,component:we}),r.a.createElement(u.c,{strict:!0,exact:!0,path:"/",component:me}),r.a.createElement(u.c,{component:ue})),r.a.createElement(_,null)):r.a.createElement(ae,null))})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(m.ToastProvider,{placement:"bottom-center"},r.a.createElement(xe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[261,1,2]]]);
//# sourceMappingURL=main.6fb521e7.chunk.js.map